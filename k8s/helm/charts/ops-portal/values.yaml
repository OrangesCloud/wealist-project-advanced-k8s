# =============================================================================
# ops-portal Helm Chart - Default Values
# =============================================================================
# Admin Portal Frontend - React SPA served by Nginx
# Service-specific configuration only.
# Global settings (namespace, environment, imageRegistry, domain) are defined
# in helm/environments/*.yaml files.

# -----------------------------------------------------------------------------
# Image Configuration
# -----------------------------------------------------------------------------
image:
  repository: ops-portal
  # pullPolicy and tag are set in helm/environments/*.yaml

imagePullSecrets: []

# -----------------------------------------------------------------------------
# Deployment Configuration
# -----------------------------------------------------------------------------
replicaCount: 1

strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

# -----------------------------------------------------------------------------
# Service Configuration
# -----------------------------------------------------------------------------
service:
  type: ClusterIP
  port: 80
  targetPort: 80
  annotations: {}

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
# Frontend is served by nginx and proxies API calls to ops-service
# No environment variables needed as it's a static SPA

config: {}

# -----------------------------------------------------------------------------
# Secrets
# -----------------------------------------------------------------------------
secrets: {}

# -----------------------------------------------------------------------------
# Health Checks
# -----------------------------------------------------------------------------
healthCheck:
  liveness:
    enabled: true
    path: /health
    port: 80
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 3

  readiness:
    enabled: true
    path: /health
    port: 80
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    successThreshold: 1
    failureThreshold: 3

# -----------------------------------------------------------------------------
# Resource Limits
# -----------------------------------------------------------------------------
resources:
  requests:
    memory: "64Mi"
    cpu: "25m"
  limits:
    memory: "128Mi"
    cpu: "100m"

# -----------------------------------------------------------------------------
# Autoscaling (HPA)
# -----------------------------------------------------------------------------
autoscaling:
  enabled: false  # Admin portal frontend has low traffic
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 101  # nginx user
  fsGroup: 101
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 101

serviceAccount:
  create: true
  annotations: {}
  name: ""

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
# Nginx doesn't have Prometheus metrics by default
metrics:
  enabled: false

podAnnotations: {}

# -----------------------------------------------------------------------------
# Pod Disruption Budget
# -----------------------------------------------------------------------------
podDisruptionBudget:
  enabled: false

# -----------------------------------------------------------------------------
# Advanced Configuration
# -----------------------------------------------------------------------------
nodeSelector: {}
tolerations: []
affinity: {}
